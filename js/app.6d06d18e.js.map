{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/views/timeline/Leaflet.vue?5491","webpack:///./src/views/timeline/FlightTooltip.vue?04c9","webpack:///./src/views/timeline/Timeline.vue?1e47","webpack:///./src/views/info/TheInfo.vue?2f10","webpack:///./src/views/Setup.vue?71a5","webpack:///./src/App.vue?88ad","webpack:///./src/views/timeline/TheTimeline.vue?72c7","webpack:///./src/views/timeline/Timeline.vue?36ae","webpack:///./src/App.vue?4da0","webpack:///./src/App.vue","webpack:///./src/App.vue?3acc","webpack:///./src/App.vue?dfb6","webpack:///./src/views/timeline/TheTimeline.vue","webpack:///./src/views/timeline/index.ts","webpack:///./src/views/timeline/Leaflet.vue","webpack:///./src/views/timeline/Leaflet.vue?569d","webpack:///./src/views/timeline/Leaflet.vue?e18b","webpack:///./src/views/timeline/Timeline.vue","webpack:///./src/views/timeline/DatePager.vue","webpack:///./src/views/timeline/DatePager.vue?5ca6","webpack:///./src/views/timeline/DatePager.vue?8955","webpack:///./src/views/timeline/FlightTooltip.vue","webpack:///./src/views/timeline/FlightTooltip.vue?24ae","webpack:///./src/views/timeline/FlightTooltip.vue?0d4f","webpack:///./src/views/timeline/Timeline.vue?c079","webpack:///./src/views/timeline/Timeline.vue?5673","webpack:///./src/views/timeline/TheTimeline.vue?b060","webpack:///./src/views/timeline/TheTimeline.vue?7cb2","webpack:///./src/views/Setup.vue","webpack:///./src/shared/DataService.ts","webpack:///./src/shared/adsb/TraceFileFields.ts","webpack:///./src/shared/Flight.ts","webpack:///./src/views/Setup.vue?1f61","webpack:///./src/views/Setup.vue?1a6e","webpack:///./src/views/info/TheInfo.vue","webpack:///./src/views/info/Leaflet.vue","webpack:///./src/views/info/InfoTooltip.vue","webpack:///./src/views/info/InfoTooltip.vue?544b","webpack:///./src/views/info/InfoTooltip.vue?2374","webpack:///./src/views/info/Leaflet.vue?15c3","webpack:///./src/views/info/Leaflet.vue?f304","webpack:///./src/views/info/TheInfo.vue?6084","webpack:///./src/views/info/TheInfo.vue?fb3b","webpack:///./src/store/types.ts","webpack:///./src/store/index.ts","webpack:///./src/router/index.ts","webpack:///./src/main.ts","webpack:///./src/views/info/Leaflet.vue?36e8","webpack:///./src/views/info/TheInfo.vue?46e8","webpack:///./src/views/timeline/DatePager.vue?7e4b"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","href","to","render","__scopeId","class","events","tooltipContent","highlightFlight","dateRangeChanged","selectedPolylineId","selectedFlightId","fields","this","id","zoom","center","map","undefined","polylines","Map","selectedPolyline","props","polylineColor","type","String","default","polylineWeight","Number","polylineWeightHighlighted","polylineColorHighlighted","computed","watch","style","polyline","bounds","getBounds","fitBounds","flights","flight","has","_id","coords","traces","lat","lon","className","color","weight","set","addTo","keys","flightId","existingFlight","find","remove","delete","mounted","zoomControl","attributionControl","setView","stamenLayer","addLayer","beforeUnmount","ref","setDateRange","$event","title","content","duration","size","label","disabled","enabled","previous","formattedDate","next","components","ElRadioGroup","ElRadioButton","emits","selectedDate","Date","Boolean","dateRange","$emit","unitType","format","toString","startOf","toDate","endOf","methods","subtract","add","field","DateRange","FlightTooltip","minDate","maxDate","Array","daysInDomain","diff","maxZoomFactor","minDisplayedDays","labels","keyLabels","e","event","debounceDateRangeChanged","from","zoomBehavior","zoomRect","margin","top","right","bottom","left","xScale","zoomScale","yScale","xAxisDefinition","xAxis","tracksSelection","defaultSelection","svg","eventsSelection","clipRect","resizeObserver","ResizeObserver","entries","onResize","resetZoom","transform","range","domain","scale","scalesChanged","domainMin","domainMax","rescaleX","forEach","entry","outerSize","height","contentRect","width","innerSize","Math","max","attr","extent","paddingBottom","rangeRound","bandwidth","kl","y","xEnd","end","xStart","start","join","enter","append","on","classed","update","exit","selectAll","g","text","sort","created","padding","scaleExtent","observe","$refs","getFlights","aircraft","aircrafts","a","icao","flightEnd","date","flightStart","totalMinutes","totalHours","floor","minutes","model","getAircrafts","filter","f","dates","LeafletMap","Leaflet","Timeline","xmlns","viewBox","stroke-width","stroke","fill","stroke-linecap","stroke-linejoin","x1","y1","x2","y2","points","multiple","loadData","target","files","isLoading","status","db","addFlight","put","createIndex","index","selector","$gte","$lte","findResponse","docs","doc","getFlightsByIds","ids","$in","response","toLowerCase","isSelected","dataExists","info","doc_count","plugin","TraceFileFields","tc","hex","timestamp","replace","flightDate","unix","trace","flags","Flags","SecondsAfterTimestamp","Lat","Lon","altitudeFt","AltitudeFt","groundSpeedKts","GroundSpeedKts","trackDeg","TrackDeg","isStale","isLeg","isVerticalRateGeometric","isAltitudeGeometric","verticalRateFpm","VerticalRateFpm","JSON","adsbTraces","parse","console","warn","error","$router","infoText","tooltipContents","aircraftName","formatDate","dayjsFormat","InfoTooltip","keyboard","dragging","scrollWheelZoom","doubleClickZoom","InfoMap","getInfoText","buttons","document","getElementsByClassName","button","flightIds","getAttribute","split","addEventListener","CHECK_IF_DATA_EXSISTS","GET_AIRCRAFTS","GET_INFO_TEXT","GET_FLIGHTS","store","state","selectedFlights","tracks","mutations","actions","commit","flightInfos","payload","checkIfDataExists","routes","path","component","Setup","alias","TheTimeline","meta","requireData","TheInfo","router","history","beforeEach","dispatch","matched","some","record","plugins","app","App","use","mount"],"mappings":"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","file":"js/app.6d06d18e.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/seabats/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Leaflet.vue?vue&type=style&index=0&id=8ea8bb84&scoped=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./FlightTooltip.vue?vue&type=style&index=0&id=73929900&scoped=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Timeline.vue?vue&type=style&index=1&id=37ce5392&scoped=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./TheInfo.vue?vue&type=style&index=0&id=307b6ff0&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Setup.vue?vue&type=style&index=0&id=66f0291a&scoped=true&lang=css\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=1&id=295a8f17&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./TheTimeline.vue?vue&type=style&index=0&id=4a59f6e5&scoped=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Timeline.vue?vue&type=style&index=0&id=37ce5392&lang=css\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&id=295a8f17&lang=scss\"","<template>\n  <nav>\n    <router-link to=\"/\">MAP</router-link>\n    <router-link to=\"/info\">INFO</router-link>\n  </nav>\n  <main>\n    <router-view />\n  </main>\n  <footer>\n    <p>\n      MAP TILES: &copy;\n      <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>\n      contributors &copy;\n      <a href=\"https://carto.com/attributions\">CARTO</a>\n    </p>\n    <p>\n      WEBSITE: © 2021 Michael Schnerring, Sebastian Deuss |\n      <a href=\"https://github.com/schnerring/seabats\">GitHub</a>\n    </p>\n  </footer>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({});\n</script>\n\n<style lang=\"scss\">\nhtml,\nbody {\n  margin: 0;\n  padding: 0;\n  font-family: \"Helvetica Neue\", Helvetica, \"PingFang SC\", \"Hiragino Sans GB\",\n    \"Microsoft YaHei\", \"微软雅黑\", Arial, sans-serif;\n}\n:root {\n  /* Material Blue */\n  --blue: #1148fe;\n  --grey: #e9e9e9;\n  --grey2: #acacac;\n  --grey3: #707070;\n  --white: #ffffff;\n  --black: #818181;\n}\n\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  color: #2c3e50;\n  display: grid;\n  grid-template-areas:\n    \"nav\"\n    \"main\";\n  grid-template-rows: auto 1fr;\n  height: 100vh;\n}\n\n::-webkit-scrollbar {\n  height: 5px;\n  width: 5px;\n  scrollbar-width: auto;\n}\n::-webkit-scrollbar-thumb {\n  background: #262626;\n}\n\na {\n  color: var(--blue);\n}\n</style>\n\n<style lang=\"scss\" scoped>\nnav {\n  border-bottom: var(--grey2) solid 1px;\n  display: flex;\n  font-size: 14pt;\n  grid-area: nav;\n  justify-content: space-between;\n  padding: 5px;\n\n  a {\n    color: var(--blue);\n    font-weight: bold;\n    color: var(--black);\n\n    &.router-link-exact-active {\n      color: var(--blue);\n    }\n  }\n}\n\nmain {\n  grid-area: main;\n  overflow: hidden;\n}\n\nfooter {\n  text-align: right;\n  position: absolute;\n  bottom: 0;\n  right: 10px;\n  font-size: 11px;\n  text-rendering: optimizeLegibility;\n  color: var(--grey3);\n  grid-area: footer;\n  text-align: right;\n  z-index: 500;\n  background: transparent;\n}\nfooter a {\n  color: inherit;\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({});\n","import { render } from \"./App.vue?vue&type=template&id=295a8f17&scoped=true\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=295a8f17&lang=scss\"\nimport \"./App.vue?vue&type=style&index=1&id=295a8f17&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-295a8f17\"\n\nexport default script","<template>\n  <div class=\"parent\">\n    <div class=\"timeline\">\n      <timeline\n        :events=\"events\"\n        :tooltipContent=\"tooltipContent\"\n        @event-click=\"highlightFlight\"\n        @date-range-changed=\"dateRangeChanged\"\n      />\n    </div>\n    <div class=\"map\">\n      <leaflet-map :selectedPolylineId=\"selectedFlightId\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport dayjs from \"dayjs\";\nimport { defineComponent } from \"vue\";\nimport { mapState, mapActions } from \"vuex\";\nimport { first, last, find } from \"lodash\";\n\nimport { TooltipContent, IEvent } from \".\";\nimport LeafletMap from \"./Leaflet.vue\";\nimport Timeline from \"./Timeline.vue\";\n\nimport { Flight } from \"@/shared/Flight\";\nimport { Aircraft } from \"@/shared/Aircraft\";\n\nexport default defineComponent({\n  data(): {\n    events: IEvent<Flight>[];\n    tooltipContent: TooltipContent | undefined;\n    selectedFlightId: string | undefined;\n  } {\n    return {\n      events: [],\n      tooltipContent: undefined,\n      selectedFlightId: undefined,\n    };\n  },\n  methods: {\n    async dateRangeChanged(from: Date, to: Date) {\n      await this.getFlights({ from, to });\n    },\n    highlightFlight(event: IEvent<Flight>) {\n      this.selectedFlightId = event.data._id;\n      const aircraft = find(\n        this.aircrafts,\n        (a: Aircraft) => a.icao === event.data.icao\n      );\n\n      const flightEnd = last(event.data.traces)?.date;\n      const flightStart = first(event.data.traces)?.date;\n      const totalMinutes = dayjs(flightEnd).diff(flightStart, \"minutes\");\n      const totalHours = Math.floor(totalMinutes / 60);\n      const minutes = totalMinutes % 60;\n      this.tooltipContent = new TooltipContent([\n        {\n          key: \"DATE\",\n          value: dayjs(event.data.date).format(\"YYYY-MM-DD\"),\n        },\n        {\n          key: \"TIME\",\n          value: dayjs(event.data.date).format(\"HH:mm\"),\n          // value: `#${event.data.icao}`,\n        },\n        {\n          key: \"DURATION\",\n          value: `${totalHours.toString()}h ${minutes}m`,\n        },\n        {\n          key: \"TYPE\",\n          value: aircraft.model,\n        },\n      ]);\n    },\n    ...mapActions([\"getAircrafts\", \"getFlights\"]),\n  },\n  computed: {\n    ...mapState([\"aircrafts\", \"flights\"]),\n  },\n  watch: {\n    async flights(flights: Flight[]) {\n      await this.getAircrafts();\n      this.events = flights\n        .filter((f) => f.traces && f.traces.length > 0) // TODO any()?\n        .map((f) => {\n          const dates = f.traces.map((t) => t.date);\n          const aircraft = find(\n            this.aircrafts,\n            (a: Aircraft) => a.icao === f.icao\n          ); // TODO dictionary\n          return {\n            data: f,\n            label: aircraft.model,\n            key: f.icao,\n            start: first(dates),\n            end: last(dates),\n          } as IEvent<Flight>;\n        });\n    },\n  },\n  components: {\n    LeafletMap,\n    Timeline,\n    // FlightTooltip,\n  },\n});\n</script>\n\n<style scoped>\n.parent {\n  display: grid;\n  grid-template-areas:\n    \"timeline\"\n    \"map\";\n  grid-template-rows: auto 1fr;\n}\n.parent,\n.map {\n  height: 100%;\n}\n.timeline {\n  height: 240px;\n  width: 100%;\n  grid-area: timeline;\n}\n.map {\n  grid-area: map;\n}\n</style>\n","export interface ITimeline {\n  min: Date;\n  max: Date;\n  tracks: IEventBase[];\n}\n\nexport interface IEventBase {\n  key: string;\n  label: string;\n  start: Date;\n  end: Date;\n}\n\nexport interface IEvent<T> extends IEventBase {\n  data: T;\n}\n\nexport class TooltipContent {\n  fields: { key: string; value: string }[];\n  constructor(fields: { key: string; value: string }[]) {\n    this.fields = fields;\n  }\n}\n","<template>\n  <div id=\"leaflet\"></div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport { select, Selection, BaseType } from \"d3\";\nimport { Map as LeafletMap, LatLng, TileLayer, Polyline } from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport { mapState } from \"vuex\";\nimport { Flight } from \"@/shared/Flight\";\n\nexport default defineComponent({\n  data(): {\n    zoom: number;\n    center: LatLng;\n    map: LeafletMap | undefined;\n    polylines: Map<string, Polyline>;\n    selectedPolyline:\n      | Selection<BaseType, unknown, HTMLElement, any>\n      | undefined;\n  } {\n    return {\n      zoom: 6,\n      center: new LatLng(35.917973, 14.409943),\n      map: undefined,\n      polylines: new Map(),\n      selectedPolyline: undefined,\n    };\n  },\n  props: {\n    polylineColor: {\n      type: String,\n      default: \"white\", // TODO var?\n    },\n    polylineWeight: {\n      type: Number,\n      default: 1,\n    },\n    polylineWeightHighlighted: {\n      type: Number,\n      default: 2,\n    },\n    polylineColorHighlighted: {\n      type: String,\n      default: \"#1148fe\",\n    },\n    selectedPolylineId: {\n      type: String,\n    },\n  },\n  computed: {\n    ...mapState([\"flights\"]),\n  },\n  watch: {\n    selectedPolylineId() {\n      this.selectedPolyline\n        ?.style(\"stroke-width\", \"1\")\n        .style(\"stroke\", \"white\");\n      this.selectedPolyline = undefined;\n\n      if (this.selectedPolylineId) {\n        this.selectedPolyline = select(`.polyline_${this.selectedPolylineId}`)\n          .style(\"stroke\", `${this.polylineColorHighlighted}`)\n          .style(\"stroke-width\", `${this.polylineWeightHighlighted}px`);\n\n        const polyline = this.polylines.get(this.selectedPolylineId);\n        if (polyline) {\n          if (!this.map) return;\n          const bounds = polyline.getBounds();\n          this.map.fitBounds(bounds);\n        }\n      }\n    },\n    flights(flights: Flight[]) {\n      for (const flight of flights) {\n        if (this.polylines.has(flight._id)) {\n          continue;\n        }\n        const coords = flight.traces.map((t) => new LatLng(t.lat, t.lon));\n        const polyline = new Polyline(coords, {\n          className: `polyline_${flight._id}`,\n          color: this.polylineColor,\n          weight: this.polylineWeight,\n        });\n        // Add the polyline to the Typescript map\n        this.polylines.set(flight._id, polyline);\n        // Render the polyline in Leaflet\n        polyline.addTo(this.map as LeafletMap);\n      }\n      for (const flightId of this.polylines.keys()) {\n        const existingFlight = flights.find(\n          (flight) => flight._id === flightId\n        );\n        if (existingFlight) {\n          continue;\n        }\n        // Un-render the polyline from Leaflet\n        this.polylines.get(flightId)?.remove();\n        // remove the polyline from the Typescript Map\n        this.polylines.delete(flightId);\n      }\n    },\n  },\n  mounted() {\n    this.map = new LeafletMap(\"leaflet\", {\n      //renderer: new Canvas(),\n      zoomControl: false,\n      attributionControl: false,\n    });\n    this.map.setView(this.center, this.zoom);\n\n    const stamenLayer = new TileLayer(\n      \"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\n    );\n    this.map.addLayer(stamenLayer);\n  },\n  beforeUnmount() {\n    this.map?.remove();\n  },\n});\n</script>\n\n<style scoped>\n#leaflet {\n  height: inherit;\n  z-index: inherit;\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\nimport { select, Selection, BaseType } from \"d3\";\nimport { Map as LeafletMap, LatLng, TileLayer, Polyline } from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport { mapState } from \"vuex\";\nimport { Flight } from \"@/shared/Flight\";\n\nexport default defineComponent({\n  data(): {\n    zoom: number;\n    center: LatLng;\n    map: LeafletMap | undefined;\n    polylines: Map<string, Polyline>;\n    selectedPolyline:\n      | Selection<BaseType, unknown, HTMLElement, any>\n      | undefined;\n  } {\n    return {\n      zoom: 6,\n      center: new LatLng(35.917973, 14.409943),\n      map: undefined,\n      polylines: new Map(),\n      selectedPolyline: undefined,\n    };\n  },\n  props: {\n    polylineColor: {\n      type: String,\n      default: \"white\", // TODO var?\n    },\n    polylineWeight: {\n      type: Number,\n      default: 1,\n    },\n    polylineWeightHighlighted: {\n      type: Number,\n      default: 2,\n    },\n    polylineColorHighlighted: {\n      type: String,\n      default: \"#1148fe\",\n    },\n    selectedPolylineId: {\n      type: String,\n    },\n  },\n  computed: {\n    ...mapState([\"flights\"]),\n  },\n  watch: {\n    selectedPolylineId() {\n      this.selectedPolyline\n        ?.style(\"stroke-width\", \"1\")\n        .style(\"stroke\", \"white\");\n      this.selectedPolyline = undefined;\n\n      if (this.selectedPolylineId) {\n        this.selectedPolyline = select(`.polyline_${this.selectedPolylineId}`)\n          .style(\"stroke\", `${this.polylineColorHighlighted}`)\n          .style(\"stroke-width\", `${this.polylineWeightHighlighted}px`);\n\n        const polyline = this.polylines.get(this.selectedPolylineId);\n        if (polyline) {\n          if (!this.map) return;\n          const bounds = polyline.getBounds();\n          this.map.fitBounds(bounds);\n        }\n      }\n    },\n    flights(flights: Flight[]) {\n      for (const flight of flights) {\n        if (this.polylines.has(flight._id)) {\n          continue;\n        }\n        const coords = flight.traces.map((t) => new LatLng(t.lat, t.lon));\n        const polyline = new Polyline(coords, {\n          className: `polyline_${flight._id}`,\n          color: this.polylineColor,\n          weight: this.polylineWeight,\n        });\n        // Add the polyline to the Typescript map\n        this.polylines.set(flight._id, polyline);\n        // Render the polyline in Leaflet\n        polyline.addTo(this.map as LeafletMap);\n      }\n      for (const flightId of this.polylines.keys()) {\n        const existingFlight = flights.find(\n          (flight) => flight._id === flightId\n        );\n        if (existingFlight) {\n          continue;\n        }\n        // Un-render the polyline from Leaflet\n        this.polylines.get(flightId)?.remove();\n        // remove the polyline from the Typescript Map\n        this.polylines.delete(flightId);\n      }\n    },\n  },\n  mounted() {\n    this.map = new LeafletMap(\"leaflet\", {\n      //renderer: new Canvas(),\n      zoomControl: false,\n      attributionControl: false,\n    });\n    this.map.setView(this.center, this.zoom);\n\n    const stamenLayer = new TileLayer(\n      \"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\n    );\n    this.map.addLayer(stamenLayer);\n  },\n  beforeUnmount() {\n    this.map?.remove();\n  },\n});\n","import { render } from \"./Leaflet.vue?vue&type=template&id=8ea8bb84&scoped=true\"\nimport script from \"./Leaflet.vue?vue&type=script&lang=ts\"\nexport * from \"./Leaflet.vue?vue&type=script&lang=ts\"\n\nimport \"./Leaflet.vue?vue&type=style&index=0&id=8ea8bb84&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-8ea8bb84\"\n\nexport default script","<template>\n  <div class=\"timeline\">\n    <div class=\"d3\" ref=\"d3\"></div>\n    <div class=\"info-bar\">\n      <date-range @dateRangeChanged=\"setDateRange($event)\" />\n      <div class=\"event-info\"></div>\n      <div class=\"event-info\" v-if=\"tooltipContent\" :key=\"tooltipContent.title\">\n        <flight-tooltip :content=\"tooltipContent\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport DateRange from \"./DatePager.vue\";\nimport { defineComponent } from \"vue\";\nimport dayjs from \"dayjs\";\nimport { debounce, uniqBy } from \"lodash\";\nimport { IEventBase } from \".\";\n\nimport {\n  scaleTime,\n  zoom,\n  axisBottom,\n  select,\n  selectAll,\n  Axis,\n  NumberValue,\n  ScaleBand,\n  scaleBand,\n  Selection,\n  ScaleTime,\n  BaseType,\n  ZoomBehavior,\n  D3ZoomEvent,\n  zoomIdentity,\n} from \"d3\";\n\nimport { TooltipContent } from \".\";\nimport FlightTooltip from \"./FlightTooltip.vue\";\n\nexport default defineComponent({\n  emits: [\"eventClick\", \"dateRangeChanged\"],\n  components: {\n    DateRange,\n    FlightTooltip,\n  },\n  props: {\n    minDate: {\n      type: Date,\n      default: new Date(2021, 0, 1),\n    },\n    maxDate: {\n      type: Date,\n      default: new Date(2021, 11, 31),\n    },\n    events: {\n      type: Array as () => IEventBase[],\n      default: [] as IEventBase[],\n    },\n    tooltipContent: {\n      type: TooltipContent,\n      default: undefined,\n    },\n  },\n  computed: {\n    daysInDomain(): number {\n      return dayjs(this.maxDate).diff(dayjs(this.minDate), \"days\", true);\n    },\n    maxZoomFactor(): number {\n      const minDisplayedDays = 4;\n      return this.daysInDomain / minDisplayedDays;\n    },\n    labels(): { key: string; label: string }[] {\n      const keyLabels = this.events.map((e) => {\n        return {\n          key: e.key,\n          label: e.label,\n        };\n      });\n      return uniqBy(keyLabels, (event) => event.key);\n    },\n  },\n  data() {\n    return {\n      debounceDateRangeChanged: debounce((from: Date, to: Date) => {\n        this.$emit(\"dateRangeChanged\", from, to);\n      }, 1000),\n      zoomBehavior: {} as ZoomBehavior<SVGRectElement, unknown>,\n      zoomRect: {} as Selection<SVGRectElement, unknown, HTMLElement, unknown>,\n      margin: { top: 10, right: 30, bottom: 10, left: 150 },\n      xScale: {} as ScaleTime<number, number, never>,\n      zoomScale: {} as ScaleTime<number, number, never>,\n      yScale: {} as ScaleBand<string>,\n      xAxisDefinition: {} as Axis<Date | NumberValue>,\n      xAxis: {} as Selection<SVGGElement, unknown, HTMLElement, unknown>,\n      tracksSelection: {} as Selection<\n        BaseType,\n        { key: string; label: string },\n        SVGGElement,\n        unknown\n      >,\n      defaultSelection: [] as number[],\n      svg: {} as Selection<SVGSVGElement, unknown, HTMLElement, unknown>,\n      eventsSelection: {} as Selection<\n        SVGRectElement,\n        IEventBase,\n        SVGGElement,\n        unknown\n      >,\n      clipRect: {} as Selection<SVGRectElement, unknown, HTMLElement, unknown>,\n      resizeObserver: new ResizeObserver(\n        debounce((entries) => {\n          this.onResize(entries);\n        }, 250)\n      ),\n    };\n  },\n  methods: {\n    resetZoom() {\n      this.zoomBehavior.transform(this.zoomRect, zoomIdentity);\n    },\n    setDateRange(range: [Date, Date]) {\n      const from = range[0];\n      const to = range[1];\n\n      this.zoomScale = this.zoomScale.domain([from, to]);\n      this.xAxisDefinition.scale(this.zoomScale);\n      this.scalesChanged();\n\n      const domainMin = this.zoomScale.domain()[0];\n      const domainMax = this.zoomScale.domain()[1];\n      this.debounceDateRangeChanged(domainMin, domainMax);\n    },\n    zoom(event: D3ZoomEvent<SVGRectElement, unknown>) {\n      this.zoomScale = event.transform.rescaleX(this.xScale);\n      this.xAxisDefinition.scale(this.zoomScale);\n      this.scalesChanged();\n\n      const domainMin = this.zoomScale.domain()[0];\n      const domainMax = this.zoomScale.domain()[1];\n      this.debounceDateRangeChanged(domainMin, domainMax);\n    },\n    onResize(entries: ResizeObserverEntry[]) {\n      entries.forEach((entry) => {\n        const outerSize = {\n          height: entry.contentRect.height,\n          width: entry.contentRect.width,\n        };\n        const innerSize = {\n          height: Math.max(\n            0,\n            outerSize.height - this.margin.top - this.margin.bottom\n          ),\n          width: Math.max(\n            0,\n            outerSize.width - this.margin.left - this.margin.right\n          ),\n        };\n\n        this.svg\n          .attr(\"width\", innerSize.width)\n          .attr(\"height\", innerSize.height);\n\n        this.zoomRect\n          .attr(\"width\", innerSize.width)\n          .attr(\"height\", innerSize.height);\n\n        this.zoomBehavior.extent([\n          [0, 0],\n          [innerSize.width, innerSize.height],\n        ]);\n        this.clipRect\n          .attr(\"width\", innerSize.width)\n          .attr(\"height\", innerSize.height);\n        const paddingBottom = 20;\n\n        this.zoomScale.rangeRound([0, innerSize.width]);\n        this.xScale.rangeRound([0, innerSize.width]);\n        this.yScale.rangeRound([0, innerSize.height - paddingBottom]);\n\n        this.scalesChanged();\n      });\n    },\n    scalesChanged() {\n      selectAll(\".track-rect\")\n        .attr(\"width\", this.zoomScale.range()[1])\n        .attr(\"height\", this.yScale.bandwidth);\n\n      selectAll<SVGGElement, { key: string; label: string }>(\n        \".track-group\"\n      ).attr(\"transform\", (kl) => {\n        const y = this.yScale(kl.key);\n        return y === undefined ? \"translate(0, 0)\" : `translate(0, ${y})`;\n      });\n\n      selectAll<SVGRectElement, IEventBase>(\".event\")\n        .attr(\"width\", (event) => {\n          const xEnd = this.zoomScale(event.end);\n          const xStart = this.zoomScale(event.start);\n          return Math.max(10, xEnd - xStart);\n        })\n        .attr(\"height\", this.yScale.bandwidth)\n        .attr(\n          \"transform\",\n          (event) =>\n            `translate(${this.zoomScale(event.start)}, ${this.yScale(\n              event.key\n            )})`\n        );\n\n      this.xAxis\n        .attr(\"transform\", `translate(0, ${this.yScale.range()[1]})`)\n        .call(this.xAxisDefinition);\n    },\n  },\n  watch: {\n    events() {\n      this.eventsSelection = this.eventsSelection\n        .data(this.events, (e) => e.key)\n        .join(\n          (enter) =>\n            enter\n              .append(\"rect\")\n              .attr(\"class\", \"event\")\n              .attr(\"fill\", \"var(--white)\")\n              .on(\"click.select\", function () {\n                selectAll(\".selected-track\").classed(\"selected-track\", false);\n                select(this).classed(\"selected-track\", true);\n                select(this).attr(\"selected\");\n              })\n              .on(\"click.emit\", (event, data) =>\n                this.$emit(\"eventClick\", data)\n              ),\n          (update) => {\n            return update;\n          },\n          (exit) => {\n            exit.selectAll(\".selected-track\").classed(\"selected-track\", false);\n            return exit.remove();\n          }\n        );\n\n      this.tracksSelection = this.tracksSelection\n        .data(this.labels, (d) => d.key)\n        .join(\n          (enter) => {\n            const g = enter.append(\"g\").attr(\"class\", \"track-group\");\n            g.append(\"rect\")\n              .attr(\"class\", \"track-rect\")\n              .attr(\"fill\", \"var(--grey2)\");\n            g.append(\"text\")\n              .attr(\"class\", \"track-label\")\n              .attr(\"text-anchor\", \"end\")\n              .attr(\"dominant-baseline\", \"text-before-edge\")\n              .attr(\"transform\", \"translate(-10, 0)\")\n              .attr(\"text-align\", \"right\")\n              .text((d) => d.label);\n            return g;\n          },\n          (update) => {\n            return update;\n          },\n          (exit) => {\n            return exit.remove();\n          }\n        );\n\n      this.yScale.domain(this.labels.map((kl) => kl.key).sort());\n      this.scalesChanged();\n    },\n  },\n  created() {\n    // Read timeline zoom from last visit\n    // const from = localStorage.getItem(\"timeline.zoom.from\");\n    // if (from) {\n    //   this.zoom.from = dayjs(from).toDate();\n    // }\n    this.xScale = scaleTime().domain([this.minDate, this.maxDate]);\n    this.zoomScale = this.xScale;\n    this.yScale = scaleBand().padding(0.6);\n    this.xAxisDefinition = axisBottom(this.xScale);\n  },\n  mounted() {\n    this.svg = select(\".d3\")\n      .append(\"svg\")\n      .attr(\"class\", \"canvas\")\n      .attr(\"transform\", `translate(${this.margin.left}, ${this.margin.top})`)\n      .style(\"overflow\", \"visible\");\n\n    this.xAxis = this.svg\n      .append(\"g\")\n      .attr(\"class\", \"x-axis\")\n      .call(this.xAxisDefinition);\n\n    this.tracksSelection = this.svg\n      .append(\"g\")\n      .attr(\"class\", \"tracks-g\")\n      .selectAll(\".track\");\n\n    this.zoomBehavior = zoom<SVGRectElement, unknown>()\n      .scaleExtent([0.25, 999999]) // This control how much you can unzoom (x0.5) and zoom (x20)\n      .on(\"zoom\", this.zoom);\n\n    this.zoomRect = this.svg\n      .append(\"rect\")\n      .style(\"fill\", \"none\")\n      .style(\"pointer-events\", \"all\")\n      .call(this.zoomBehavior);\n    //.on(\"mousedown.zoom\", null);\n    // TODO\n    // .on(\"touchstart.zoom\", null)\n    // .on(\"touchmove.zoom\", null)\n    // .on(\"touchend.zoom\", null);\n\n    this.clipRect = this.svg\n      .append(\"defs\")\n      .append(\"clipPath\")\n      .attr(\"id\", \"EventsClip\")\n      .append(\"rect\")\n      .attr(\"fill\", \"transparent\");\n\n    this.eventsSelection = this.svg\n      .append(\"g\")\n      .attr(\"class\", \"events-g\")\n      .attr(\"clip-path\", \"url(#EventsClip)\")\n      .selectAll(\".event\");\n\n    this.resizeObserver.observe(this.$refs[\"d3\"] as Element);\n\n    this.$emit(\"dateRangeChanged\", this.minDate, this.maxDate);\n  },\n});\n</script>\n<style>\n/* TODO remove global state? */\n.selected-track {\n  fill: var(--blue);\n}\n</style>\n<style scoped>\n.timeline {\n  background: var(--grey);\n  border-bottom: var(--grey2) solid 1px;\n  display: grid;\n  height: inherit;\n  grid-template-areas:\n    \"d3\"\n    \"info-bar\";\n  grid-template-rows: 1fr auto;\n}\n.d3 {\n  color: var(--grey2);\n  grid-area: d3;\n  height: 100%;\n  opacity: 1;\n  width: inherit;\n}\n.info-bar {\n  display: flex;\n  justify-content: space-between;\n  grid-area: info-bar;\n  margin: 10px 30px 10px 150px;\n}\n</style>\n","<template>\n  <div class=\"date-range\">\n    <el-radio-group v-model=\"duration\" size=\"medium\">\n      <el-radio-button label=\"year\"></el-radio-button>\n      <el-radio-button label=\"month\"></el-radio-button>\n      <el-radio-button label=\"week\" disabled></el-radio-button>\n      <el-radio-button label=\"day\"></el-radio-button>\n    </el-radio-group>\n    <div class=\"date-pager\">\n      <button v-if=\"enabled\" class=\"pager-button\" @click=\"previous()\">\n        &lt;\n      </button>\n      <div class=\"current\">{{ formattedDate }}</div>\n      <button v-if=\"enabled\" class=\"pager-button\" @click=\"next()\">&gt;</button>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport dayjs, { UnitType } from \"dayjs\";\nimport { ElRadioButton, ElRadioGroup } from \"element-plus\";\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  components: {\n    ElRadioGroup,\n    ElRadioButton,\n  },\n  emits: [\"dateRangeChanged\"],\n  data(): { selectedDate: Date; duration: string } {\n    return {\n      selectedDate: new Date(2021, 6, 15),\n      duration: \"year\",\n    };\n  },\n  props: {\n    enabled: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  watch: {\n    dateRange() {\n      this.$emit(\"dateRangeChanged\", this.dateRange);\n    },\n  },\n  computed: {\n    formattedDate(): string {\n      const unitType = this.duration as UnitType;\n      if (unitType === \"year\") {\n        return dayjs(this.selectedDate).format(\"YYYY\").toString();\n      } else if (unitType === \"month\") {\n        return dayjs(this.selectedDate).format(\"YYYY / MM\").toString();\n      } else if (unitType === \"day\") {\n        return dayjs(this.selectedDate).format(\"YYYY / MM / DD\").toString();\n      }\n      throw `Unsupported unitType ${unitType}`;\n    },\n    dateRange(): [Date, Date] {\n      const unitType = this.duration as UnitType;\n      return [\n        dayjs(this.selectedDate).startOf(unitType).toDate(),\n        dayjs(this.selectedDate).endOf(unitType).toDate(),\n      ];\n    },\n  },\n  methods: {\n    previous() {\n      const unitType = this.duration as UnitType;\n      this.selectedDate = dayjs(this.selectedDate)\n        .subtract(1, unitType)\n        .toDate();\n    },\n    next() {\n      const unitType = this.duration as UnitType;\n      this.selectedDate = dayjs(this.selectedDate).add(1, unitType).toDate();\n    },\n  },\n});\n</script>\n\n<style scoped>\n.date-range {\n  display: flex;\n  flex-direction: row;\n}\n\n.date-pager {\n  box-sizing: border-box;\n  background: var(--white);\n  color: var(--grey3);\n  font-size: 14px;\n  border: solid 1px #dcdfe6;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n}\n.date-pager:hover {\n  background: var(--grey3);\n  color: var(--white);\n  cursor: default;\n  border: solid 1px var(--grey3);\n}\n\n.pager-button {\n  color: inherit;\n  background: transparent;\n  border: 0;\n  font-family: inherit;\n  font-size: inherit;\n  height: 100%;\n  padding: 0px 9px;\n}\n.pager-button:hover {\n  cursor: pointer;\n}\n</style>\n","\nimport dayjs, { UnitType } from \"dayjs\";\nimport { ElRadioButton, ElRadioGroup } from \"element-plus\";\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  components: {\n    ElRadioGroup,\n    ElRadioButton,\n  },\n  emits: [\"dateRangeChanged\"],\n  data(): { selectedDate: Date; duration: string } {\n    return {\n      selectedDate: new Date(2021, 6, 15),\n      duration: \"year\",\n    };\n  },\n  props: {\n    enabled: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  watch: {\n    dateRange() {\n      this.$emit(\"dateRangeChanged\", this.dateRange);\n    },\n  },\n  computed: {\n    formattedDate(): string {\n      const unitType = this.duration as UnitType;\n      if (unitType === \"year\") {\n        return dayjs(this.selectedDate).format(\"YYYY\").toString();\n      } else if (unitType === \"month\") {\n        return dayjs(this.selectedDate).format(\"YYYY / MM\").toString();\n      } else if (unitType === \"day\") {\n        return dayjs(this.selectedDate).format(\"YYYY / MM / DD\").toString();\n      }\n      throw `Unsupported unitType ${unitType}`;\n    },\n    dateRange(): [Date, Date] {\n      const unitType = this.duration as UnitType;\n      return [\n        dayjs(this.selectedDate).startOf(unitType).toDate(),\n        dayjs(this.selectedDate).endOf(unitType).toDate(),\n      ];\n    },\n  },\n  methods: {\n    previous() {\n      const unitType = this.duration as UnitType;\n      this.selectedDate = dayjs(this.selectedDate)\n        .subtract(1, unitType)\n        .toDate();\n    },\n    next() {\n      const unitType = this.duration as UnitType;\n      this.selectedDate = dayjs(this.selectedDate).add(1, unitType).toDate();\n    },\n  },\n});\n","import { render } from \"./DatePager.vue?vue&type=template&id=479c438f&scoped=true\"\nimport script from \"./DatePager.vue?vue&type=script&lang=ts\"\nexport * from \"./DatePager.vue?vue&type=script&lang=ts\"\n\nimport \"./DatePager.vue?vue&type=style&index=0&id=479c438f&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-479c438f\"\n\nexport default script","<template>\n  <div id=\"Tooltip-Container\">\n    <div class=\"single-tooltip\">\n      <span v-for=\"field of content.fields\" :key=\"field.key\">\n        <strong>{{ field.key }}</strong>\n\n        {{ field.value }}</span\n      >\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport { TooltipContent } from \".\";\n\nexport default defineComponent({\n  props: {\n    content: {\n      type: TooltipContent,\n    },\n  },\n});\n</script>\n\n<style scoped>\nh1 {\n  font-size: 16pt;\n}\n\nh1,\np {\n  margin: 0;\n  padding: 0;\n}\n\np.subtitle {\n  color: lightgray;\n  font-size: 14pt;\n}\n\n#Tooltip-Container {\n  display: flex;\n  text-transform: uppercase;\n  flex-direction: row;\n  height: 100%;\n  align-items: center;\n  color: var(--blue);\n}\n.single-tooltip span {\n  margin-left: 10px;\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\nimport { TooltipContent } from \".\";\n\nexport default defineComponent({\n  props: {\n    content: {\n      type: TooltipContent,\n    },\n  },\n});\n","import { render } from \"./FlightTooltip.vue?vue&type=template&id=73929900&scoped=true\"\nimport script from \"./FlightTooltip.vue?vue&type=script&lang=ts\"\nexport * from \"./FlightTooltip.vue?vue&type=script&lang=ts\"\n\nimport \"./FlightTooltip.vue?vue&type=style&index=0&id=73929900&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-73929900\"\n\nexport default script","\nimport DateRange from \"./DatePager.vue\";\nimport { defineComponent } from \"vue\";\nimport dayjs from \"dayjs\";\nimport { debounce, uniqBy } from \"lodash\";\nimport { IEventBase } from \".\";\n\nimport {\n  scaleTime,\n  zoom,\n  axisBottom,\n  select,\n  selectAll,\n  Axis,\n  NumberValue,\n  ScaleBand,\n  scaleBand,\n  Selection,\n  ScaleTime,\n  BaseType,\n  ZoomBehavior,\n  D3ZoomEvent,\n  zoomIdentity,\n} from \"d3\";\n\nimport { TooltipContent } from \".\";\nimport FlightTooltip from \"./FlightTooltip.vue\";\n\nexport default defineComponent({\n  emits: [\"eventClick\", \"dateRangeChanged\"],\n  components: {\n    DateRange,\n    FlightTooltip,\n  },\n  props: {\n    minDate: {\n      type: Date,\n      default: new Date(2021, 0, 1),\n    },\n    maxDate: {\n      type: Date,\n      default: new Date(2021, 11, 31),\n    },\n    events: {\n      type: Array as () => IEventBase[],\n      default: [] as IEventBase[],\n    },\n    tooltipContent: {\n      type: TooltipContent,\n      default: undefined,\n    },\n  },\n  computed: {\n    daysInDomain(): number {\n      return dayjs(this.maxDate).diff(dayjs(this.minDate), \"days\", true);\n    },\n    maxZoomFactor(): number {\n      const minDisplayedDays = 4;\n      return this.daysInDomain / minDisplayedDays;\n    },\n    labels(): { key: string; label: string }[] {\n      const keyLabels = this.events.map((e) => {\n        return {\n          key: e.key,\n          label: e.label,\n        };\n      });\n      return uniqBy(keyLabels, (event) => event.key);\n    },\n  },\n  data() {\n    return {\n      debounceDateRangeChanged: debounce((from: Date, to: Date) => {\n        this.$emit(\"dateRangeChanged\", from, to);\n      }, 1000),\n      zoomBehavior: {} as ZoomBehavior<SVGRectElement, unknown>,\n      zoomRect: {} as Selection<SVGRectElement, unknown, HTMLElement, unknown>,\n      margin: { top: 10, right: 30, bottom: 10, left: 150 },\n      xScale: {} as ScaleTime<number, number, never>,\n      zoomScale: {} as ScaleTime<number, number, never>,\n      yScale: {} as ScaleBand<string>,\n      xAxisDefinition: {} as Axis<Date | NumberValue>,\n      xAxis: {} as Selection<SVGGElement, unknown, HTMLElement, unknown>,\n      tracksSelection: {} as Selection<\n        BaseType,\n        { key: string; label: string },\n        SVGGElement,\n        unknown\n      >,\n      defaultSelection: [] as number[],\n      svg: {} as Selection<SVGSVGElement, unknown, HTMLElement, unknown>,\n      eventsSelection: {} as Selection<\n        SVGRectElement,\n        IEventBase,\n        SVGGElement,\n        unknown\n      >,\n      clipRect: {} as Selection<SVGRectElement, unknown, HTMLElement, unknown>,\n      resizeObserver: new ResizeObserver(\n        debounce((entries) => {\n          this.onResize(entries);\n        }, 250)\n      ),\n    };\n  },\n  methods: {\n    resetZoom() {\n      this.zoomBehavior.transform(this.zoomRect, zoomIdentity);\n    },\n    setDateRange(range: [Date, Date]) {\n      const from = range[0];\n      const to = range[1];\n\n      this.zoomScale = this.zoomScale.domain([from, to]);\n      this.xAxisDefinition.scale(this.zoomScale);\n      this.scalesChanged();\n\n      const domainMin = this.zoomScale.domain()[0];\n      const domainMax = this.zoomScale.domain()[1];\n      this.debounceDateRangeChanged(domainMin, domainMax);\n    },\n    zoom(event: D3ZoomEvent<SVGRectElement, unknown>) {\n      this.zoomScale = event.transform.rescaleX(this.xScale);\n      this.xAxisDefinition.scale(this.zoomScale);\n      this.scalesChanged();\n\n      const domainMin = this.zoomScale.domain()[0];\n      const domainMax = this.zoomScale.domain()[1];\n      this.debounceDateRangeChanged(domainMin, domainMax);\n    },\n    onResize(entries: ResizeObserverEntry[]) {\n      entries.forEach((entry) => {\n        const outerSize = {\n          height: entry.contentRect.height,\n          width: entry.contentRect.width,\n        };\n        const innerSize = {\n          height: Math.max(\n            0,\n            outerSize.height - this.margin.top - this.margin.bottom\n          ),\n          width: Math.max(\n            0,\n            outerSize.width - this.margin.left - this.margin.right\n          ),\n        };\n\n        this.svg\n          .attr(\"width\", innerSize.width)\n          .attr(\"height\", innerSize.height);\n\n        this.zoomRect\n          .attr(\"width\", innerSize.width)\n          .attr(\"height\", innerSize.height);\n\n        this.zoomBehavior.extent([\n          [0, 0],\n          [innerSize.width, innerSize.height],\n        ]);\n        this.clipRect\n          .attr(\"width\", innerSize.width)\n          .attr(\"height\", innerSize.height);\n        const paddingBottom = 20;\n\n        this.zoomScale.rangeRound([0, innerSize.width]);\n        this.xScale.rangeRound([0, innerSize.width]);\n        this.yScale.rangeRound([0, innerSize.height - paddingBottom]);\n\n        this.scalesChanged();\n      });\n    },\n    scalesChanged() {\n      selectAll(\".track-rect\")\n        .attr(\"width\", this.zoomScale.range()[1])\n        .attr(\"height\", this.yScale.bandwidth);\n\n      selectAll<SVGGElement, { key: string; label: string }>(\n        \".track-group\"\n      ).attr(\"transform\", (kl) => {\n        const y = this.yScale(kl.key);\n        return y === undefined ? \"translate(0, 0)\" : `translate(0, ${y})`;\n      });\n\n      selectAll<SVGRectElement, IEventBase>(\".event\")\n        .attr(\"width\", (event) => {\n          const xEnd = this.zoomScale(event.end);\n          const xStart = this.zoomScale(event.start);\n          return Math.max(10, xEnd - xStart);\n        })\n        .attr(\"height\", this.yScale.bandwidth)\n        .attr(\n          \"transform\",\n          (event) =>\n            `translate(${this.zoomScale(event.start)}, ${this.yScale(\n              event.key\n            )})`\n        );\n\n      this.xAxis\n        .attr(\"transform\", `translate(0, ${this.yScale.range()[1]})`)\n        .call(this.xAxisDefinition);\n    },\n  },\n  watch: {\n    events() {\n      this.eventsSelection = this.eventsSelection\n        .data(this.events, (e) => e.key)\n        .join(\n          (enter) =>\n            enter\n              .append(\"rect\")\n              .attr(\"class\", \"event\")\n              .attr(\"fill\", \"var(--white)\")\n              .on(\"click.select\", function () {\n                selectAll(\".selected-track\").classed(\"selected-track\", false);\n                select(this).classed(\"selected-track\", true);\n                select(this).attr(\"selected\");\n              })\n              .on(\"click.emit\", (event, data) =>\n                this.$emit(\"eventClick\", data)\n              ),\n          (update) => {\n            return update;\n          },\n          (exit) => {\n            exit.selectAll(\".selected-track\").classed(\"selected-track\", false);\n            return exit.remove();\n          }\n        );\n\n      this.tracksSelection = this.tracksSelection\n        .data(this.labels, (d) => d.key)\n        .join(\n          (enter) => {\n            const g = enter.append(\"g\").attr(\"class\", \"track-group\");\n            g.append(\"rect\")\n              .attr(\"class\", \"track-rect\")\n              .attr(\"fill\", \"var(--grey2)\");\n            g.append(\"text\")\n              .attr(\"class\", \"track-label\")\n              .attr(\"text-anchor\", \"end\")\n              .attr(\"dominant-baseline\", \"text-before-edge\")\n              .attr(\"transform\", \"translate(-10, 0)\")\n              .attr(\"text-align\", \"right\")\n              .text((d) => d.label);\n            return g;\n          },\n          (update) => {\n            return update;\n          },\n          (exit) => {\n            return exit.remove();\n          }\n        );\n\n      this.yScale.domain(this.labels.map((kl) => kl.key).sort());\n      this.scalesChanged();\n    },\n  },\n  created() {\n    // Read timeline zoom from last visit\n    // const from = localStorage.getItem(\"timeline.zoom.from\");\n    // if (from) {\n    //   this.zoom.from = dayjs(from).toDate();\n    // }\n    this.xScale = scaleTime().domain([this.minDate, this.maxDate]);\n    this.zoomScale = this.xScale;\n    this.yScale = scaleBand().padding(0.6);\n    this.xAxisDefinition = axisBottom(this.xScale);\n  },\n  mounted() {\n    this.svg = select(\".d3\")\n      .append(\"svg\")\n      .attr(\"class\", \"canvas\")\n      .attr(\"transform\", `translate(${this.margin.left}, ${this.margin.top})`)\n      .style(\"overflow\", \"visible\");\n\n    this.xAxis = this.svg\n      .append(\"g\")\n      .attr(\"class\", \"x-axis\")\n      .call(this.xAxisDefinition);\n\n    this.tracksSelection = this.svg\n      .append(\"g\")\n      .attr(\"class\", \"tracks-g\")\n      .selectAll(\".track\");\n\n    this.zoomBehavior = zoom<SVGRectElement, unknown>()\n      .scaleExtent([0.25, 999999]) // This control how much you can unzoom (x0.5) and zoom (x20)\n      .on(\"zoom\", this.zoom);\n\n    this.zoomRect = this.svg\n      .append(\"rect\")\n      .style(\"fill\", \"none\")\n      .style(\"pointer-events\", \"all\")\n      .call(this.zoomBehavior);\n    //.on(\"mousedown.zoom\", null);\n    // TODO\n    // .on(\"touchstart.zoom\", null)\n    // .on(\"touchmove.zoom\", null)\n    // .on(\"touchend.zoom\", null);\n\n    this.clipRect = this.svg\n      .append(\"defs\")\n      .append(\"clipPath\")\n      .attr(\"id\", \"EventsClip\")\n      .append(\"rect\")\n      .attr(\"fill\", \"transparent\");\n\n    this.eventsSelection = this.svg\n      .append(\"g\")\n      .attr(\"class\", \"events-g\")\n      .attr(\"clip-path\", \"url(#EventsClip)\")\n      .selectAll(\".event\");\n\n    this.resizeObserver.observe(this.$refs[\"d3\"] as Element);\n\n    this.$emit(\"dateRangeChanged\", this.minDate, this.maxDate);\n  },\n});\n","import { render } from \"./Timeline.vue?vue&type=template&id=37ce5392&scoped=true\"\nimport script from \"./Timeline.vue?vue&type=script&lang=ts\"\nexport * from \"./Timeline.vue?vue&type=script&lang=ts\"\n\nimport \"./Timeline.vue?vue&type=style&index=0&id=37ce5392&lang=css\"\nimport \"./Timeline.vue?vue&type=style&index=1&id=37ce5392&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-37ce5392\"\n\nexport default script","\nimport dayjs from \"dayjs\";\nimport { defineComponent } from \"vue\";\nimport { mapState, mapActions } from \"vuex\";\nimport { first, last, find } from \"lodash\";\n\nimport { TooltipContent, IEvent } from \".\";\nimport LeafletMap from \"./Leaflet.vue\";\nimport Timeline from \"./Timeline.vue\";\n\nimport { Flight } from \"@/shared/Flight\";\nimport { Aircraft } from \"@/shared/Aircraft\";\n\nexport default defineComponent({\n  data(): {\n    events: IEvent<Flight>[];\n    tooltipContent: TooltipContent | undefined;\n    selectedFlightId: string | undefined;\n  } {\n    return {\n      events: [],\n      tooltipContent: undefined,\n      selectedFlightId: undefined,\n    };\n  },\n  methods: {\n    async dateRangeChanged(from: Date, to: Date) {\n      await this.getFlights({ from, to });\n    },\n    highlightFlight(event: IEvent<Flight>) {\n      this.selectedFlightId = event.data._id;\n      const aircraft = find(\n        this.aircrafts,\n        (a: Aircraft) => a.icao === event.data.icao\n      );\n\n      const flightEnd = last(event.data.traces)?.date;\n      const flightStart = first(event.data.traces)?.date;\n      const totalMinutes = dayjs(flightEnd).diff(flightStart, \"minutes\");\n      const totalHours = Math.floor(totalMinutes / 60);\n      const minutes = totalMinutes % 60;\n      this.tooltipContent = new TooltipContent([\n        {\n          key: \"DATE\",\n          value: dayjs(event.data.date).format(\"YYYY-MM-DD\"),\n        },\n        {\n          key: \"TIME\",\n          value: dayjs(event.data.date).format(\"HH:mm\"),\n          // value: `#${event.data.icao}`,\n        },\n        {\n          key: \"DURATION\",\n          value: `${totalHours.toString()}h ${minutes}m`,\n        },\n        {\n          key: \"TYPE\",\n          value: aircraft.model,\n        },\n      ]);\n    },\n    ...mapActions([\"getAircrafts\", \"getFlights\"]),\n  },\n  computed: {\n    ...mapState([\"aircrafts\", \"flights\"]),\n  },\n  watch: {\n    async flights(flights: Flight[]) {\n      await this.getAircrafts();\n      this.events = flights\n        .filter((f) => f.traces && f.traces.length > 0) // TODO any()?\n        .map((f) => {\n          const dates = f.traces.map((t) => t.date);\n          const aircraft = find(\n            this.aircrafts,\n            (a: Aircraft) => a.icao === f.icao\n          ); // TODO dictionary\n          return {\n            data: f,\n            label: aircraft.model,\n            key: f.icao,\n            start: first(dates),\n            end: last(dates),\n          } as IEvent<Flight>;\n        });\n    },\n  },\n  components: {\n    LeafletMap,\n    Timeline,\n    // FlightTooltip,\n  },\n});\n","import { render } from \"./TheTimeline.vue?vue&type=template&id=4a59f6e5&scoped=true\"\nimport script from \"./TheTimeline.vue?vue&type=script&lang=ts\"\nexport * from \"./TheTimeline.vue?vue&type=script&lang=ts\"\n\nimport \"./TheTimeline.vue?vue&type=style&index=0&id=4a59f6e5&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-4a59f6e5\"\n\nexport default script","<template>\n  <div class=\"parent\">\n    <div class=\"child\">\n      <h1>Hello! You Need Data To Use This App</h1>\n\n      <p>\n        Sorry, we currently don't have a license to publicly redistribute any of\n        our test data.\n      </p>\n\n      <p>\n        Please contact one of the project maintainers to request a sample data\n        set.\n      </p>\n\n      <label>\n        <input\n          type=\"file\"\n          ref=\"file\"\n          multiple=\"multiple\"\n          @change=\"loadData($event.target.files)\"\n          :disabled=\"isLoading\"\n        />\n\n        <!--\n          Tabler Icon \"loader\"\n          Copyright (c) 2020 Paweł Kuna\n          Source: https://tablericons.com/\n          License: MIT\n        -->\n        <svg\n          v-if=\"isLoading\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          class=\"icon icon-tabler icon-tabler-loader\"\n          width=\"44\"\n          height=\"44\"\n          viewBox=\"0 0 24 24\"\n          stroke-width=\"1.5\"\n          stroke=\"#2c3e50\"\n          fill=\"none\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n        >\n          <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" />\n          <line x1=\"12\" y1=\"6\" x2=\"12\" y2=\"3\" />\n          <line x1=\"16.25\" y1=\"7.75\" x2=\"18.4\" y2=\"5.6\" />\n          <line x1=\"18\" y1=\"12\" x2=\"21\" y2=\"12\" />\n          <line x1=\"16.25\" y1=\"16.25\" x2=\"18.4\" y2=\"18.4\" />\n          <line x1=\"12\" y1=\"18\" x2=\"12\" y2=\"21\" />\n          <line x1=\"7.75\" y1=\"16.25\" x2=\"5.6\" y2=\"18.4\" />\n          <line x1=\"6\" y1=\"12\" x2=\"3\" y2=\"12\" />\n          <line x1=\"7.75\" y1=\"7.75\" x2=\"5.6\" y2=\"5.6\" />\n        </svg>\n\n        <!--\n          Tabler Icon \"upload\"\n          Copyright (c) 2020 Paweł Kuna\n          Source: https://tablericons.com/\n          License: MIT\n        -->\n        <svg\n          v-else\n          xmlns=\"http://www.w3.org/2000/svg\"\n          class=\"icon icon-tabler icon-tabler-upload\"\n          width=\"44\"\n          height=\"44\"\n          viewBox=\"0 0 24 24\"\n          stroke-width=\"1.5\"\n          stroke=\"#2c3e50\"\n          fill=\"none\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n        >\n          <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" />\n          <path d=\"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2\" />\n          <polyline points=\"7 9 12 4 17 9\" />\n          <line x1=\"12\" y1=\"4\" x2=\"12\" y2=\"16\" />\n        </svg>\n\n        <p class=\"status-text\">\n          {{ status }}\n        </p>\n      </label>\n\n      <p>\n        If you want to provide your own data,\n        <a href=\"https://github.com/schnerring/seabats/blob/main/README.md\"\n          >read more about the expected data format</a\n        >.\n      </p>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport { AdsbExchangeResponse } from \"@/shared/adsb/AdsbExchangeResponse\";\nimport { addFlight } from \"@/shared/DataService\";\nimport { Flight } from \"@/shared/Flight\";\n\nexport default defineComponent({\n  data() {\n    return {\n      isLoading: false,\n    };\n  },\n  computed: {\n    status(): string {\n      return this.isLoading\n        ? \"Loading ...\"\n        : \"Click here to select a data set from the local file system\";\n    },\n  },\n  methods: {\n    async loadData(files: FileList) {\n      this.isLoading = true;\n      try {\n        for (let i = 0; i < files.length; i++) {\n          const adsbTraces: AdsbExchangeResponse[] = JSON.parse(\n            await files[i].text()\n          );\n          for (const trace of adsbTraces) {\n            try {\n              const flight = new Flight(trace);\n              await addFlight(flight);\n            } catch {\n              console.warn(trace);\n            }\n          }\n        }\n      } catch (error) {\n        // TODO show error to user\n        console.error(error);\n      } finally {\n        this.isLoading = false;\n      }\n\n      this.$router.push(\"/\");\n    },\n  },\n});\n</script>\n\n<style scoped>\n.parent {\n  height: 100%;\n  text-align: center;\n}\n.parent,\n.child {\n  display: grid;\n  place-items: center;\n}\n.status-text {\n  font-size: 9pt;\n  margin-top: 0.2rem;\n}\ninput[type=\"file\"] {\n  display: none;\n}\nlabel {\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  margin: 40px 0;\n}\nlabel:hover {\n  color: var(--blue);\n  cursor: pointer;\n}\nlabel:hover svg {\n  stroke: var(--blue);\n  transform: translateY(-5px);\n}\nsvg {\n  transition: transform 0.4s ease-in-out;\n}\nsvg.icon-tabler-loader {\n  animation: spin 1s linear infinite;\n}\n@keyframes spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","import PouchDB from \"pouchdb\";\nimport find from \"pouchdb-find\";\nimport { Aircraft } from \"./Aircraft\";\nimport { Flight } from \"./Flight\";\nimport axios from \"axios\";\nimport marked from \"marked\";\n\nconst db = new PouchDB(\"flights\");\nPouchDB.plugin(find);\n\nexport async function addFlight(flight: Flight): Promise<void> {\n  try {\n    await db.put(flight);\n  } catch (error) {\n    if (error.name === \"conflict\") {\n      //console.info(`Skip duplicate flight: ${flight._id}, ${flight.date}`);\n    } else {\n      throw error;\n    }\n  }\n}\n\nexport async function getFlights(from: Date, to: Date): Promise<Flight[]> {\n  await db.createIndex({\n    index: {\n      fields: [\"date\"],\n    },\n  });\n  const findResponse = await db.find({\n    selector: {\n      date: { $gte: from, $lte: to },\n    },\n  });\n  return findResponse.docs.map(\n    (doc) => doc as PouchDB.Core.ExistingDocument<Flight>\n  );\n}\n\nexport async function getFlightsByIds(ids: string[]): Promise<Flight[]> {\n  const findResponse = await db.find({\n    selector: {\n      _id: { $in: ids },\n    },\n  });\n  return findResponse.docs.map(\n    (doc) => doc as PouchDB.Core.ExistingDocument<Flight>\n  );\n}\n\nexport async function getInfoText(): Promise<string> {\n  const response = await axios.get<string>(\"info-text.md\");\n  return marked(response.data);\n}\n\nexport async function getAircrafts(): Promise<Aircraft[]> {\n  const response = await axios.get<Aircraft[]>(\"aircrafts.json\");\n  for (const aircraft of response.data) {\n    aircraft.icao = aircraft.icao.toLowerCase();\n    aircraft.isSelected = true;\n  }\n  return response.data;\n}\n\nexport async function dataExists(): Promise<boolean> {\n  return (await db.info()).doc_count > 0;\n}\n","// Mapping of ADS-B Exchange Version 2 API Trace File Fields\n// See also: https://www.adsbexchange.com/version-2-api-wip/\nexport enum TraceFileFields {\n  SecondsAfterTimestamp,\n  Lat,\n  Lon,\n  // Nullable\n  AltitudeFt,\n  // Nullable\n  GroundSpeedKts,\n  // Nullable\n  TrackDeg,\n  // Bit field:\n  //   (flags & 1 > 0): position is stale (no position received for 20 seconds before this one)\n  //   (flags & 2 > 0): start of a new leg (tries to detect a separation point between landing and takeoff that separates fligths)\n  //   (flags & 4 > 0): vertical rate is geometric and not barometric\n  //   (flags & 8 > 0): altitude is geometric and not barometric\n  Flags,\n  // Nullable\n  VerticalRateFpm,\n  // Nullable\n  Aircraft,\n}\n","import { Trace } from \"./Trace\";\nimport { AdsbExchangeResponse } from \"@/shared/adsb/AdsbExchangeResponse\";\nimport { TraceFileFields } from \"@/shared/adsb/TraceFileFields\";\nimport dayjs from \"dayjs\";\n\nexport class Flight {\n  _id: string;\n  date: Date;\n  icao: string;\n  traces: Trace[];\n\n  // ADSB Exchange\n  constructor(tc: AdsbExchangeResponse) {\n    this.icao = tc.icao ?? tc.hex;\n    this._id = `${this.icao}-${tc.timestamp}`.replace(\".\", \"_\");\n    const flightDate = dayjs.unix(tc.timestamp);\n    this.date = flightDate.toDate();\n    this.traces = tc.trace.map((t) => {\n      const flags = t[TraceFileFields.Flags] as number;\n      return {\n        date: flightDate\n          .add(t[TraceFileFields.SecondsAfterTimestamp] as number, \"seconds\")\n          .toDate(),\n        lat: t[TraceFileFields.Lat],\n        lon: t[TraceFileFields.Lon],\n        altitudeFt: t[TraceFileFields.AltitudeFt],\n        groundSpeedKts: t[TraceFileFields.GroundSpeedKts],\n        trackDeg: t[TraceFileFields.TrackDeg],\n        isStale: (flags & 1) > 0,\n        isLeg: (flags & 2) > 0,\n        isVerticalRateGeometric: (flags & 4) > 0,\n        isAltitudeGeometric: (flags & 8) > 0,\n        verticalRateFpm: t[TraceFileFields.VerticalRateFpm],\n        // TODO map the last field of aircraft info?\n      } as Trace;\n    });\n  }\n}\n","\nimport { defineComponent } from \"vue\";\nimport { AdsbExchangeResponse } from \"@/shared/adsb/AdsbExchangeResponse\";\nimport { addFlight } from \"@/shared/DataService\";\nimport { Flight } from \"@/shared/Flight\";\n\nexport default defineComponent({\n  data() {\n    return {\n      isLoading: false,\n    };\n  },\n  computed: {\n    status(): string {\n      return this.isLoading\n        ? \"Loading ...\"\n        : \"Click here to select a data set from the local file system\";\n    },\n  },\n  methods: {\n    async loadData(files: FileList) {\n      this.isLoading = true;\n      try {\n        for (let i = 0; i < files.length; i++) {\n          const adsbTraces: AdsbExchangeResponse[] = JSON.parse(\n            await files[i].text()\n          );\n          for (const trace of adsbTraces) {\n            try {\n              const flight = new Flight(trace);\n              await addFlight(flight);\n            } catch {\n              console.warn(trace);\n            }\n          }\n        }\n      } catch (error) {\n        // TODO show error to user\n        console.error(error);\n      } finally {\n        this.isLoading = false;\n      }\n\n      this.$router.push(\"/\");\n    },\n  },\n});\n","import { render } from \"./Setup.vue?vue&type=template&id=66f0291a&scoped=true\"\nimport script from \"./Setup.vue?vue&type=script&lang=ts\"\nexport * from \"./Setup.vue?vue&type=script&lang=ts\"\n\nimport \"./Setup.vue?vue&type=style&index=0&id=66f0291a&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-66f0291a\"\n\nexport default script","<template>\n  <div class=\"info-map\">\n    <div class=\"info\" v-html=\"infoText\"></div>\n    <info-map :flights=\"flights\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport { mapState, mapActions } from \"vuex\";\n\nimport InfoMap from \"./Leaflet.vue\";\n\nimport { getFlightsByIds } from \"@/shared/DataService\";\nimport { Flight } from \"@/shared/Flight\";\n\nexport default defineComponent({\n  computed: {\n    ...mapState([\"infoText\"]),\n  },\n  methods: {\n    ...mapActions([\"getInfoText\"]),\n  },\n  components: {\n    InfoMap,\n  },\n  data(): { flights: Flight[] } {\n    return {\n      flights: [],\n    };\n  },\n  async mounted() {\n    await this.getInfoText();\n    const buttons = document.getElementsByClassName(\"data-link\");\n    for (const button of buttons) {\n      const flightIds = button.getAttribute(\"data\")?.split(\",\");\n      if (!flightIds) throw \"data-link requires data attribute\";\n      button.addEventListener(\"click\", async () => {\n        this.flights = await getFlightsByIds(flightIds);\n      });\n    }\n  },\n});\n</script>\n<style>\n.data-link {\n  border: none;\n  background: none;\n  padding: 0;\n  color: blue;\n  cursor: pointer;\n  font-size: inherit;\n}\n.data-link::before {\n  content: \"✈\";\n}\n</style>\n<style scoped>\n.opensky-attribution {\n  font-style: italic;\n}\n.info-map {\n  display: flex;\n  flex-direction: row;\n  height: 100%;\n}\n.info {\n  width: 100%;\n  padding: 5px 30px;\n  box-sizing: border-box;\n  overflow-y: scroll;\n}\ndiv#leaflet {\n  height: 100%;\n  width: 50vw;\n}\n</style>\n","<template>\n  <div class=\"leaflet-container\">\n    <div id=\"leaflet\"></div>\n    <div class=\"tooltip-list\">\n      <info-tooltip\n        class=\"tooltip-box\"\n        v-for=\"tooltipContent of tooltipContents\"\n        :key=\"tooltipContent\"\n        :from=\"tooltipContent.from\"\n        :to=\"tooltipContent.to\"\n        :aircraftName=\"tooltipContent.aircraftName\"\n      />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport InfoTooltip from \"./InfoTooltip.vue\";\nimport {\n  Map as LeafletMap,\n  LatLng,\n  TileLayer,\n  Polyline,\n  FeatureGroup,\n} from \"leaflet\";\nimport { Flight } from \"@/shared/Flight\";\nimport { last, first, find } from \"lodash\";\nimport { mapState, mapActions } from \"vuex\";\nimport { Aircraft } from \"@/shared/Aircraft\";\n\nexport default defineComponent({\n  components: {\n    InfoTooltip,\n  },\n  data(): {\n    zoom: number;\n    center: LatLng;\n    map: LeafletMap | undefined;\n    polylines: FeatureGroup | undefined;\n    tooltipContents: { from: Date; to: Date; aircraftName: string }[];\n  } {\n    return {\n      zoom: 6,\n      center: new LatLng(35.917973, 14.409943),\n      map: undefined,\n      polylines: undefined,\n      tooltipContents: [],\n    };\n  },\n  props: {\n    flights: {\n      default: () => [] as Flight[],\n      type: Array,\n    },\n  },\n  methods: {\n    ...mapActions([\"getAircrafts\"]),\n  },\n  computed: {\n    ...mapState([\"aircrafts\"]),\n  },\n  watch: {\n    async flights(flights: Flight[]) {\n      await this.getAircrafts();\n      if (!this.map) return;\n      if (this.polylines) {\n        this.polylines.remove();\n      }\n      if (this.tooltipContents.length > 0) {\n        this.tooltipContents = [];\n      }\n      this.polylines = new FeatureGroup<Polyline>();\n      for (const flight of flights) {\n        const aircraft = find<Aircraft>(\n          this.aircrafts,\n          (a: Aircraft) => a.icao === flight.icao\n        );\n\n        const flightEnd = last(flight.traces)?.date;\n        const flightStart = first(flight.traces)?.date;\n\n        if (!aircraft || !flightStart || !flightEnd) continue;\n\n        this.tooltipContents.push({\n          aircraftName: aircraft.model,\n          from: flightStart, //,\n          to: flightEnd, //).format(\"YYYY-MM-DD HH:mm\"),\n        });\n        const coords = flight.traces.map((t) => new LatLng(t.lat, t.lon));\n        const polyline = new Polyline(coords, {\n          className: `polyline_${flight._id}`,\n          color: \"#1148fe\",\n          weight: 2,\n        });\n        this.polylines.addLayer(polyline);\n      }\n      // Render polylines in Leaflet\n      this.polylines.addTo(this.map as LeafletMap);\n\n      this.map.fitBounds(this.polylines.getBounds());\n    },\n  },\n  mounted() {\n    this.map = new LeafletMap(\"leaflet\", {\n      //renderer: new Canvas(),\n      zoomControl: false,\n      attributionControl: false,\n      keyboard: false,\n      dragging: false,\n      scrollWheelZoom: false,\n      doubleClickZoom: false,\n    });\n    this.map.setView(this.center, this.zoom);\n\n    const stamenLayer = new TileLayer(\n      \"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\n    );\n    this.map.addLayer(stamenLayer);\n  },\n  beforeUnmount() {\n    this.map?.remove();\n  },\n});\n</script>\n\n<style scoped>\n.tooltip-list {\n  position: absolute;\n  left: 15px;\n  color: white;\n  z-index: 500;\n  top: 15px;\n  font-family: monospace;\n}\n.leaflet-container {\n  position: relative;\n  height: 100%;\n  width: 100%;\n}\n</style>\n","<template>\n  <div class=\"single-tooltip\">\n    <span\n      >from {{ formatDate(from) }} to {{ formatDate(to) }}: {{ aircraftName }}\n    </span>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport dayjs from \"dayjs\";\n\nexport default defineComponent({\n  methods: {\n    formatDate(date: Date) {\n      return dayjs(date).format(this.dayjsFormat);\n    },\n  },\n  props: {\n    from: {\n      type: Date,\n    },\n    to: {\n      type: Date,\n    },\n    aircraftName: {\n      type: String,\n    },\n    dayjsFormat: {\n      type: String,\n      default: \"YY/MM/DD HH:mm\",\n    },\n  },\n});\n</script>\n\n<style scoped></style>\n","\nimport { defineComponent } from \"vue\";\nimport dayjs from \"dayjs\";\n\nexport default defineComponent({\n  methods: {\n    formatDate(date: Date) {\n      return dayjs(date).format(this.dayjsFormat);\n    },\n  },\n  props: {\n    from: {\n      type: Date,\n    },\n    to: {\n      type: Date,\n    },\n    aircraftName: {\n      type: String,\n    },\n    dayjsFormat: {\n      type: String,\n      default: \"YY/MM/DD HH:mm\",\n    },\n  },\n});\n","import { render } from \"./InfoTooltip.vue?vue&type=template&id=0ece7360\"\nimport script from \"./InfoTooltip.vue?vue&type=script&lang=ts\"\nexport * from \"./InfoTooltip.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport { defineComponent } from \"vue\";\nimport InfoTooltip from \"./InfoTooltip.vue\";\nimport {\n  Map as LeafletMap,\n  LatLng,\n  TileLayer,\n  Polyline,\n  FeatureGroup,\n} from \"leaflet\";\nimport { Flight } from \"@/shared/Flight\";\nimport { last, first, find } from \"lodash\";\nimport { mapState, mapActions } from \"vuex\";\nimport { Aircraft } from \"@/shared/Aircraft\";\n\nexport default defineComponent({\n  components: {\n    InfoTooltip,\n  },\n  data(): {\n    zoom: number;\n    center: LatLng;\n    map: LeafletMap | undefined;\n    polylines: FeatureGroup | undefined;\n    tooltipContents: { from: Date; to: Date; aircraftName: string }[];\n  } {\n    return {\n      zoom: 6,\n      center: new LatLng(35.917973, 14.409943),\n      map: undefined,\n      polylines: undefined,\n      tooltipContents: [],\n    };\n  },\n  props: {\n    flights: {\n      default: () => [] as Flight[],\n      type: Array,\n    },\n  },\n  methods: {\n    ...mapActions([\"getAircrafts\"]),\n  },\n  computed: {\n    ...mapState([\"aircrafts\"]),\n  },\n  watch: {\n    async flights(flights: Flight[]) {\n      await this.getAircrafts();\n      if (!this.map) return;\n      if (this.polylines) {\n        this.polylines.remove();\n      }\n      if (this.tooltipContents.length > 0) {\n        this.tooltipContents = [];\n      }\n      this.polylines = new FeatureGroup<Polyline>();\n      for (const flight of flights) {\n        const aircraft = find<Aircraft>(\n          this.aircrafts,\n          (a: Aircraft) => a.icao === flight.icao\n        );\n\n        const flightEnd = last(flight.traces)?.date;\n        const flightStart = first(flight.traces)?.date;\n\n        if (!aircraft || !flightStart || !flightEnd) continue;\n\n        this.tooltipContents.push({\n          aircraftName: aircraft.model,\n          from: flightStart, //,\n          to: flightEnd, //).format(\"YYYY-MM-DD HH:mm\"),\n        });\n        const coords = flight.traces.map((t) => new LatLng(t.lat, t.lon));\n        const polyline = new Polyline(coords, {\n          className: `polyline_${flight._id}`,\n          color: \"#1148fe\",\n          weight: 2,\n        });\n        this.polylines.addLayer(polyline);\n      }\n      // Render polylines in Leaflet\n      this.polylines.addTo(this.map as LeafletMap);\n\n      this.map.fitBounds(this.polylines.getBounds());\n    },\n  },\n  mounted() {\n    this.map = new LeafletMap(\"leaflet\", {\n      //renderer: new Canvas(),\n      zoomControl: false,\n      attributionControl: false,\n      keyboard: false,\n      dragging: false,\n      scrollWheelZoom: false,\n      doubleClickZoom: false,\n    });\n    this.map.setView(this.center, this.zoom);\n\n    const stamenLayer = new TileLayer(\n      \"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\n    );\n    this.map.addLayer(stamenLayer);\n  },\n  beforeUnmount() {\n    this.map?.remove();\n  },\n});\n","import { render } from \"./Leaflet.vue?vue&type=template&id=6060e9f0&scoped=true\"\nimport script from \"./Leaflet.vue?vue&type=script&lang=ts\"\nexport * from \"./Leaflet.vue?vue&type=script&lang=ts\"\n\nimport \"./Leaflet.vue?vue&type=style&index=0&id=6060e9f0&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-6060e9f0\"\n\nexport default script","\nimport { defineComponent } from \"vue\";\nimport { mapState, mapActions } from \"vuex\";\n\nimport InfoMap from \"./Leaflet.vue\";\n\nimport { getFlightsByIds } from \"@/shared/DataService\";\nimport { Flight } from \"@/shared/Flight\";\n\nexport default defineComponent({\n  computed: {\n    ...mapState([\"infoText\"]),\n  },\n  methods: {\n    ...mapActions([\"getInfoText\"]),\n  },\n  components: {\n    InfoMap,\n  },\n  data(): { flights: Flight[] } {\n    return {\n      flights: [],\n    };\n  },\n  async mounted() {\n    await this.getInfoText();\n    const buttons = document.getElementsByClassName(\"data-link\");\n    for (const button of buttons) {\n      const flightIds = button.getAttribute(\"data\")?.split(\",\");\n      if (!flightIds) throw \"data-link requires data attribute\";\n      button.addEventListener(\"click\", async () => {\n        this.flights = await getFlightsByIds(flightIds);\n      });\n    }\n  },\n});\n","import { render } from \"./TheInfo.vue?vue&type=template&id=307b6ff0&scoped=true\"\nimport script from \"./TheInfo.vue?vue&type=script&lang=ts\"\nexport * from \"./TheInfo.vue?vue&type=script&lang=ts\"\n\nimport \"./TheInfo.vue?vue&type=style&index=0&id=307b6ff0&lang=css\"\nimport \"./TheInfo.vue?vue&type=style&index=1&id=307b6ff0&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-307b6ff0\"\n\nexport default script","export const CHECK_IF_DATA_EXSISTS = \"checkIfDataExists\";\nexport const GET_AIRCRAFTS = \"getAircrafts\";\nexport const GET_INFO_TEXT = \"getInfoText\";\nexport const GET_FLIGHTS = \"getFlights\";\n","import { State } from \"@vue/runtime-core\";\nimport { createStore } from \"vuex\";\nimport {\n  CHECK_IF_DATA_EXSISTS,\n  GET_AIRCRAFTS,\n  GET_FLIGHTS,\n  GET_INFO_TEXT,\n} from \"./types\";\nimport {\n  dataExists,\n  getAircrafts,\n  getFlights,\n  getInfoText,\n} from \"@/shared/DataService\";\n\nexport const store = createStore<State>({\n  state: {\n    aircrafts: [],\n    dataExists: false,\n    flights: [],\n    infoText: \"\",\n    selectedFlights: [],\n    tracks: [],\n  },\n  mutations: {\n    [CHECK_IF_DATA_EXSISTS](state, dataExists) {\n      state.dataExists = dataExists;\n    },\n    [GET_AIRCRAFTS](state, aircrafts) {\n      state.aircrafts = aircrafts;\n    },\n    [GET_FLIGHTS](state, flights) {\n      state.flights = flights;\n    },\n    [GET_INFO_TEXT](state, infoText) {\n      state.infoText = infoText;\n    },\n  },\n  actions: {\n    // Data\n    async getAircrafts({ commit }) {\n      const aircrafts = await getAircrafts();\n      commit(GET_AIRCRAFTS, aircrafts);\n    },\n    async getInfoText({ commit }) {\n      const flightInfos = await getInfoText();\n      commit(GET_INFO_TEXT, flightInfos);\n    },\n    async getFlights({ commit }, payload) {\n      const flights = await getFlights(payload.from, payload.to);\n      commit(GET_FLIGHTS, flights);\n    },\n    async checkIfDataExists({ commit }) {\n      commit(CHECK_IF_DATA_EXSISTS, await dataExists());\n    },\n  },\n  modules: {},\n});\n","import { createRouter, createWebHistory, RouteRecordRaw } from \"vue-router\";\nimport TheTimeline from \"@/views/timeline/TheTimeline.vue\";\nimport Setup from \"@/views/Setup.vue\";\nimport TheInfo from \"@/views/info/TheInfo.vue\";\nimport { store } from \"../store/index\";\n\nconst routes: Array<RouteRecordRaw> = [\n  {\n    path: \"/setup\",\n    name: \"Setup\",\n    component: Setup,\n  },\n  {\n    path: \"/\",\n    alias: \"/map\",\n    name: \"Map\",\n    component: TheTimeline,\n    meta: {\n      requireData: true,\n    },\n  },\n  {\n    path: \"/info\",\n    name: \"Info\",\n    component: TheInfo,\n    meta: {\n      requireData: true,\n    },\n  },\n];\n\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes,\n});\n\nrouter.beforeEach(async (to, from, next) => {\n  if (!store.state.dataExists) {\n    await store.dispatch(\"checkIfDataExists\");\n  }\n\n  if (\n    to.matched.some((record) => record.meta.requireData) &&\n    !store.state.dataExists\n  ) {\n    next(\"/setup\");\n  } else if (\n    to.matched.some((record) => record.name === \"Setup\") &&\n    store.state.dataExists\n  ) {\n    next(from);\n  } else next();\n});\n\nexport default router;\n","import { createApp } from \"vue\";\nimport App from \"./App.vue\";\nimport router from \"./router\";\nimport { store } from \"./store\";\n\n// Element Plus\nimport { ElIcon, ElNotification } from \"element-plus\";\nconst components = [ElIcon];\nconst plugins = [ElNotification];\n\nimport \"@/assets/element-variables.scss\";\n\nconst app = createApp(App).use(store).use(router);\n\ncomponents.forEach((component) => app.use(component));\nplugins.forEach((plugin) => app.use(plugin));\n\napp.mount(\"#app\");\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Leaflet.vue?vue&type=style&index=0&id=6060e9f0&scoped=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./TheInfo.vue?vue&type=style&index=1&id=307b6ff0&scoped=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./DatePager.vue?vue&type=style&index=0&id=479c438f&scoped=true&lang=css\""],"sourceRoot":""}